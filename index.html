<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>å¹½é»˜æƒ…ç·’æ€¥æ•‘åŒ… v1.2</title>

<meta name="theme-color" content="#ff9f43" />
<meta name="description" content="å¹½é»˜æƒ…ç·’æ€¥æ•‘åŒ…ï½œè’è¬¬æ€¥æ•‘Ã—å®¶é•·å¹½é»˜å›æ‡‰Ã—è‡ªå‰µå¥åº«Ã—è‡ªæˆ‘åŠ æ²¹Ã—ç‹‚æŒ‰èˆ’å£“é©šå–œï¼ˆå«å¯æ„›éŸ³æ•ˆï¼‰" />

<link rel="manifest" href="./manifest.json" />
<link rel="icon" href="./icon-192.png" />
<link rel="apple-touch-icon" href="./icon-192.png" />

<style>
  :root{
    /* âœ… æ›´å¯æ„›æ´»æ½‘ï¼šèœœæ¡ƒå¥¶æ²¹åº• + äº®æ©˜ */
    --bgA:#fff0df;
    --bgB:#ffe3c2;
    --ink:#4b3626;
    --muted:#7b614b;
    --card:rgba(255,255,255,.90);
    --shadow:0 12px 28px rgba(0,0,0,.10);
    --r:20px;

    --brand:#ff9f43;        /* æ´»æ½‘æ©˜ */
    --brand2:#ffd36e;       /* å¥¶æ²¹é»ƒ */
    --brandSoft:#fff0cc;    /* æŸ”å’Œåº• */
    --line:rgba(0,0,0,.10);

    --pill:#fff7ea;
    --pillLine:rgba(0,0,0,.08);
  }

  *{ box-sizing:border-box; }
  body{
    margin:0;
    /* âœ… åœ“æ½¤å­—é«”å„ªå…ˆåºï¼šä¸åŒæ‰‹æ©Ÿæœƒè‡ªå‹•æŒ‘æœ€åœ“çš„ */
    font-family:
      "Noto Sans TC",
      "PingFang TC",
      "Microsoft JhengHei",
      "Heiti TC",
      system-ui, -apple-system, BlinkMacSystemFont, sans-serif;

    color:var(--ink);
    background:
      radial-gradient(900px 450px at 15% 0%, #ffeef7, transparent 60%),
      radial-gradient(900px 450px at 85% 0%, #e9fff6, transparent 55%),
      linear-gradient(180deg, var(--bgA), var(--bgB));
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* âœ… æ–·å­—ä¿®æ­£ï¼šä¸­æ–‡ä¸ç¡¬åˆ‡ï¼Œä½†è¶…é•·ä¹Ÿä¸çˆ† */
  .wrapSafe{
    word-break: keep-all;
    overflow-wrap: anywhere;
    hyphens: none;
  }

  .app{
    max-width: 540px;
    margin: 0 auto;
    padding: 18px 14px 30px;
  }

  header{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:10px;
    margin-bottom: 10px;
  }

  h1{
    margin:0;
    /* âœ… æ¨™é¡Œå­—å†å°ä¸€é» + è¡Œé«˜èˆ’æœ + é¿å…å­¤å­— */
    font-size: 1.22rem;
    line-height: 1.35;
    font-weight: 700;
    letter-spacing:.02em;
    word-break: keep-all;
  }

  .subtitle{
    margin-top:6px;
    font-size: .92rem;
    line-height: 1.55;
    color: var(--muted);
    font-weight: 500;
    max-width: 320px;
  }

  .topBtns{
    display:flex;
    flex-direction:column;
    gap:8px;
    min-width: 150px;
  }

  .chipRow{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    justify-content:flex-end;
  }
  .chip{
    background: var(--pill);
    border: 1px solid var(--pillLine);
    border-radius: 999px;
    padding: 7px 10px;
    font-weight: 700;
    font-size: .82rem;
    cursor:pointer;
  }
  .chip:active{ transform: translateY(1px); }

  .card{
    background: var(--card);
    border-radius: var(--r);
    padding: 14px;
    margin: 12px 0;
    box-shadow: var(--shadow);
    border:1px solid rgba(0,0,0,.05);
  }

  .cardTitle{
    font-weight: 800;
    margin: 0 0 10px;
    font-size: 1.02rem;
  }

  .quote{
    border: 1px dashed rgba(0,0,0,.12);
    background: rgba(255,255,255,.86);
    border-radius: 16px;
    padding: 12px 12px;
    line-height: 1.65;
    font-weight: 650; /* âœ… åœ“æ½¤æ„Ÿï¼šä¸è¦å¤ªç¡¬çš„ 900 */
    text-align:center;
    font-size: .98rem;
  }

  .tiny{
    margin-top: 10px;
    font-size: .84rem;
    color: var(--muted);
    line-height: 1.5;
    text-align:center;
    font-weight: 500;
  }

  button{
    width:100%;
    border:none;
    border-radius: 999px;
    padding: 11px 12px;
    font-size: .94rem;
    line-height: 1.25;
    margin-top: 10px;
    cursor:pointer;
    font-weight: 750;
    color:#2b1f12;
    background: linear-gradient(135deg, var(--brand), var(--brand2));
    box-shadow: 0 10px 16px rgba(255,159,67,.22);
    white-space: normal;
    word-break: keep-all;
    overflow-wrap: anywhere;
  }
  button:active{ transform: translateY(1px); }

  .secondary{
    background: linear-gradient(135deg, #fff3d8, #ffffff);
    box-shadow:none;
    border: 1px solid rgba(0,0,0,.08);
  }
  .ghost{
    background: transparent;
    border: 1px dashed rgba(255,159,67,.55);
    color: #6b4f2c;
    box-shadow:none;
  }
  .small{
    font-size: .84rem;
    padding: 9px 10px;
  }
  button:disabled{
    opacity:.55;
    cursor:not-allowed;
  }

  textarea{
    width:100%;
    border-radius: 16px;
    padding: 10px 10px;
    border: 1px solid rgba(0,0,0,.12);
    font-size: .90rem;
    line-height: 1.45;
    resize: none;
    outline: none;
    background: rgba(255,255,255,.9);
  }

  .list{
    display:flex;
    flex-direction:column;
    gap:8px;
    margin-top: 10px;
  }
  .item{
    display:flex;
    gap:8px;
    align-items:flex-start;
  }
  .itemBtn{
    flex:1;
    border-radius: 16px;
    border:1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.92);
    padding: 10px 10px;
    font-weight: 700;
    cursor:pointer;
    text-align:left;
    line-height:1.45;
    font-size: .92rem;
  }
  .delBtn{
    border-radius: 16px;
    border:1px solid rgba(0,0,0,.10);
    background: rgba(255,255,255,.92);
    padding: 10px 10px;
    font-weight: 750;
    cursor:pointer;
    min-width: 64px;
  }

  .spark{
    margin-top: 10px;
    text-align:center;
    font-weight: 700;
    font-size: .88rem;
    color: #6a4a35;
    opacity:.92;
  }

  .footerNote{
    margin-top: 16px;
    text-align:center;
    font-size:.82rem;
    color: rgba(75,54,38,.70);
    font-weight: 500;
  }
</style>
</head>

<body>
<div class="app wrapSafe">

  <header>
    <div>
      <h1>ğŸ¤¡ å¹½é»˜æƒ…ç·’
æ€¥æ•‘åŒ…</h1>
      <div class="subtitle">çµ¦å·²ç¶“å¾ˆåŠªåŠ›çš„å¤§äººï¼Œä¸€å€‹å…ˆç¬‘ä¸€ä¸‹ã€å†å›ä¾†çš„ç©ºé–“</div>
    </div>

    <div class="topBtns">
      <button id="btnInstall" class="small" onclick="installApp()" disabled>ä¸€éµå®‰è£</button>

      <div class="chipRow">
        <button class="chip" type="button" onclick="toggleSound()" id="soundChip">ğŸ”ˆ éŸ³æ•ˆï¼šé–‹</button>
        <button class="chip" type="button" onclick="testSound()">ğŸµ è©¦è½</button>
      </div>

      <button class="ghost small" onclick="goConcept()">å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨</button>
      <button class="ghost small" onclick="goChannel()">å¤©ä½¿ç¬‘é•·é »é“</button>
      <button class="ghost small" onclick="openFeedback()">å›é¥‹è¡¨å–®</button>
    </div>
  </header>

  <!-- âœ… 0ï½œæ¯æ—¥å½©è›‹ï¼ˆä¸€å¤©æœ€å¤šè·³ä¸€æ¬¡ï¼‰ -->
  <div class="card">
    <div class="cardTitle">0ï½œæ¯æ—¥å½©è›‹ï¼ˆçµ¦ä½ ä¸€å€‹å·å·ç¬‘ï¼‰</div>
    <div class="quote" id="eggText">ä»Šå¤©çš„å½©è›‹é‚„æ²’æ‰“é–‹ã€‚</div>
    <button class="secondary" onclick="showDailyEgg()">ğŸ æ‰“é–‹ä»Šæ—¥å½©è›‹</button>
    <button class="ghost small" onclick="openFeedback()">æˆ‘ä¹Ÿè¦ç•™ä¸€å¥ï¼ˆå»è¡¨å–®ï¼‰</button>
    <div class="tiny">å½©è›‹ä¸€å¤©æœ€å¤šè·³ä¸€æ¬¡ï¼Œä¸åµä½ ã€‚ä½ é¡˜æ„å›ä¾†å°±å¾ˆå¥½ã€‚</div>
  </div>

  <!-- 1ï½œè’è¬¬æ€¥æ•‘ -->
  <div class="card">
    <div class="cardTitle">1ï½œè’è¬¬æ€¥æ•‘ï¼ˆå…ˆç¬‘ä¸€ä¸‹ï¼‰</div>
    <div class="quote" id="absurdText">é»ä¸€ä¸‹ï¼Œè®“è…¦å†·éœã€‚</div>
    <button onclick="absurdRescue()">å¹½è‡ªå·±ä¸€é»˜</button>
    <div class="tiny">ç¬‘ä¸æ˜¯é€ƒé¿ï¼Œæ˜¯æŠŠå¤§è…¦å¾ã€Œæ‰“æ¶æ¨¡å¼ã€æ‹‰å›ã€Œå¯ä»¥æ€è€ƒæ¨¡å¼ã€ã€‚</div>
  </div>

  <!-- 2ï½œå®¶é•·å¹½é»˜å›æ‡‰ -->
  <div class="card">
    <div class="cardTitle">2ï½œå®¶é•·å¹½é»˜å›æ‡‰ï¼ˆæ’ä½ç¾å ´ï¼‰</div>
    <div class="quote" id="parentText">å­©å­åœ¨æ°£ï¼Œå¤§äººå…ˆç©©ã€‚</div>
    <button class="secondary" onclick="parentRescue()">çµ¦æˆ‘ä¸€å¥å¹½é»˜å›æ‡‰</button>
    <div class="tiny">å…ˆæƒ³æƒ³ï¼Œç¾åœ¨ç«™ä»€éº¼å§¿å‹¢æ¯”è¼ƒå¥½ã€‚</div>
  </div>

  <!-- 3ï½œå¤§äººè‡ªæˆ‘åŠ æ²¹ -->
  <div class="card">
    <div class="cardTitle">3ï½œå¤§äººè‡ªæˆ‘åŠ æ²¹ï¼ˆè£œèƒ½é‡ Buffï¼‰</div>
    <div class="quote" id="cheerText">ä½ ä¸æ˜¯å·®å‹ï¼Œä½ åªæ˜¯ç´¯äº†ã€‚</div>
    <button class="secondary" onclick="cheerMeUp()">ğŸ’› çµ¦æˆ‘ä¸€å¥åŠ æ²¹</button>
    <div class="tiny">é€™è£¡ä¸è©•åˆ†ï¼Œåªè£œé›»ã€‚</div>
  </div>

  <!-- 4ï½œç‹‚æŒ‰èˆ’å£“é©šå–œ -->
  <div class="card">
    <div class="cardTitle">4ï½œç‹‚æŒ‰èˆ’å£“ï¼ˆæŒ‰åˆ°ä½ ç¬‘å‡ºä¾†ï¼‰</div>
    <div class="quote" id="smashText">è®“ä½ æŒ‰ï¼é€™è£¡ä¸æœƒæŒ‰å£ä»»ä½•æ±è¥¿ã€‚</div>
    <button onclick="smash()">ğŸ«§ ä¸€ç›´æŒ‰ä¹Ÿæ²’é—œä¿‚</button>
    <div class="spark" id="smashSpark"></div>
    <div class="tiny">é€£æŒ‰æœƒå‡ºç¾é©šå–œã€‚æƒ³åœå°±åœï¼Œè‡ªå·±ä¾†ï¼</div>
  </div>

  <!-- 5ï½œæˆ‘çš„å¥å­ -->
  <div class="card">
    <div class="cardTitle">5ï½œæˆ‘çš„å¥å­ï¼ˆä½ è‡ªå·±æœ€æ‡‚ä½ ï¼‰</div>
    <div class="tiny" style="text-align:left; margin-top:0;">
      æŠŠä½ ã€Œèªªå¾—å‡ºå£ã€è½èµ·ä¾†èˆ’æœã€ç”¨å®Œå¿ƒæœƒé¬†ã€çš„å¥å­å­˜èµ·ä¾†ã€‚ä¸‹æ¬¡å°±æœƒæŠ½åˆ°ã€‚
    </div>

    <textarea id="customInput" rows="2" placeholder="ä¾‹å¦‚ï¼šä½ åµä½ çš„ï¼Œæˆ‘å…ˆç·´éœå¿ƒåŠŸï¼Œæ™šé»å†ä¾†è«‡ã€‚"></textarea>
    <button class="ghost small" onclick="saveCustom()">å­˜èµ·ä¾†ï¼ˆä¸‹æ¬¡æœƒæŠ½åˆ°ï¼‰</button>

    <div class="list" id="customList"></div>
  </div>

  <div class="footerNote">v1.2ï½œå¹½é»˜æƒ…ç·’æ€¥æ•‘åŒ…ï½œé¡˜æ„å›ä¾†å°±å¾ˆå¥½ã€‚</div>
</div>

<script>
/* =========================
   é€£çµï¼ˆéœ€è¦æ”¹åªæ”¹é€™è£¡ï¼‰
========================= */
const LINKS = {
  concept: "https://angel0973180707.github.io/angel-happy-paw/",
  channel: "https://www.youtube.com/@%E5%A4%A9%E4%BD%BF%E7%AC%91%E9%95%B7",
  feedback: "https://forms.gle/EBEJ2ac45nwnq7KGA"
};

function goConcept(){ window.open(LINKS.concept, "_blank", "noopener,noreferrer"); }
function goChannel(){ window.open(LINKS.channel, "_blank", "noopener,noreferrer"); }
function openFeedback(){
  if(!LINKS.feedback) { alert("å›é¥‹è¡¨å–®å°šæœªé–‹æ”¾ï¼ˆé ç•™ä¸­ï¼‰"); return; }
  window.open(LINKS.feedback, "_blank", "noopener,noreferrer");
}

/* =========================
   ä¸€éµå®‰è£ï¼ˆæ”¯æ´æ‰æœƒäº®ï¼‰
========================= */
let deferredPrompt = null;
window.addEventListener("beforeinstallprompt", e => {
  e.preventDefault();
  deferredPrompt = e;
  const btn = document.getElementById("btnInstall");
  btn.disabled = false;
  btn.textContent = "ä¸€éµå®‰è£";
});
window.addEventListener("appinstalled", ()=>{
  const btn = document.getElementById("btnInstall");
  btn.disabled = true;
  btn.textContent = "å·²å®‰è£";
});
async function installApp(){
  if(!deferredPrompt){
    alert("æ­¤ç€è¦½å™¨ç›®å‰ç„¡æ³•ä¸€éµå®‰è£ï¼ˆä½†ä½ ä»å¯ç›´æ¥ä½¿ç”¨ ğŸ˜Šï¼‰");
    return;
  }
  deferredPrompt.prompt();
  try { await deferredPrompt.userChoice; } catch(e){}
  deferredPrompt = null;
}

/* =========================
   å°å·¥å…·
========================= */
function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

/* =========================
   âœ… å¯æ„›éŸ³æ•ˆï¼ˆç„¡éœ€å¤–éƒ¨æª”æ¡ˆï¼‰
   - ç”¨ WebAudio ç”¢ç”ŸçŸ­éŸ³è‰²
   - è¡Œå‹•è£ç½®ç¬¬ä¸€æ¬¡é»æ“Šå¾Œæœƒå•Ÿå‹•
========================= */
let SOUND_ON = true;
let audioCtx = null;

function ensureAudio(){
  if(!SOUND_ON) return null;
  if(!audioCtx){
    const AC = window.AudioContext || window.webkitAudioContext;
    if(!AC) return null;
    audioCtx = new AC();
  }
  if(audioCtx.state === "suspended"){
    audioCtx.resume().catch(()=>{});
  }
  return audioCtx;
}

function beep(type="tap"){
  if(!SOUND_ON) return;

  const ctx = ensureAudio();
  if(!ctx) return;

  const now = ctx.currentTime;
  const o = ctx.createOscillator();
  const g = ctx.createGain();

  // æ›´å¯æ„›ï¼šç”¨ triangle/sine æ··åˆæ„Ÿ
  o.type = (type === "surprise" || type === "win") ? "triangle" : "sine";

  const base = {
    tap: [740, 980],        // å•¾
    soft: [520, 660],       // æŸ”
    smash: [420, 540],      // å’š
    surprise: [880, 1320],  // å®å’š
    win: [988, 1318],       // å°å‹åˆ©
    error: [220, 180]
  }[type] || [740, 980];

  o.frequency.setValueAtTime(base[0], now);
  o.frequency.exponentialRampToValueAtTime(base[1], now + 0.06);

  // éŸ³é‡åŒ…çµ¡ï¼šå¾ˆçŸ­ã€å¾ˆå¯æ„›ã€ä¸åˆºè€³
  g.gain.setValueAtTime(0.0001, now);
  g.gain.exponentialRampToValueAtTime(0.10, now + 0.01);
  g.gain.exponentialRampToValueAtTime(0.0001, now + 0.10);

  o.connect(g);
  g.connect(ctx.destination);
  o.start(now);
  o.stop(now + 0.12);
}

function toggleSound(){
  SOUND_ON = !SOUND_ON;
  document.getElementById("soundChip").textContent = SOUND_ON ? "ğŸ”ˆ éŸ³æ•ˆï¼šé–‹" : "ğŸ”‡ éŸ³æ•ˆï¼šé—œ";
  if(SOUND_ON) beep("win");
}

function testSound(){
  beep("tap");
  setTimeout(()=>beep("surprise"), 140);
}

/* =========================
   å¥åº«
========================= */
const absurdList = [
  "æ­å–œä½ ï¼Œå‰›å‰›å·®é»æŠŠä¸€ä»¶å°äº‹æ¼”æˆå…«é»æª”ã€‚",
  "å†·éœé»ï¼Œèª°é‚£éº¼å‰å¤§ï¼Œè®“ä½ ä¸é–‹å¿ƒã€‚",
  "ç­‰ç­‰ï¼šæˆ‘å€‘å…ˆé€²å»£å‘Šã€‚",
  "æ”¾å¿ƒï¼Œä½ ä¸æ˜¯å·®å‹ï¼Œä½ åªæ˜¯ç´¯äº†ã€‚",
  "æ­¤åˆ»çš„ä½ ï¼Œéœ€è¦çš„ä¸æ˜¯æ–¹æ³•ï¼Œæ˜¯æ‰¾æ¨“æ¢¯ä¸‹ã€‚",
  "é€™ä¸€åˆ»å¦‚æœæœ‰è§€çœ¾ï¼Œæ”¶è¦–ç‡æœƒå¾ˆé«˜ã€‚",
  "å‰›å‰›é‚£ä¸€å¹•ï¼Œå¦‚æœé…éŸ³æ¨‚ï¼Œæƒ³æƒ³è¦é…ä»€éº¼ã€‚",
  "å…ˆæš«åœä¸€ä¸‹ï¼Œé€™æ®µæƒ…ç·’æ¼”å¾—æœ‰é»ç”¨åŠ›",
  "æé†’ä½ ä¸€ä¸‹ï¼Œç¾åœ¨ä¸æ˜¯å¹´åº¦å¤§çµå±€ã€‚",
  "é€™ä¸€å¹•å¯ä»¥å…ˆå‰ªæ‰ï¼Œè§€çœ¾æœƒæ„Ÿè¬ä½ ã€‚",
  "æ…¢ä¸€é»ï¼Œå°æ¼”å–Šå¡äº†ã€‚",
  "æœ‰çš„æ˜¯æ©Ÿæœƒï¼Œåˆ¥æ€¥è‘—ç¾åœ¨è´ã€‚",
  "å…ˆæš«åœï¼Œå»å–å£æ°´ã€‚"
];

const parentList = [
  "ä½ ç”Ÿæ°£ï¼Œæˆ‘ä¸æ°£ï¼Œå£è„¾æ°£æœƒè™•ç½°è‡ªå·±ã€‚",
  "ä½ å¼ä½ çš„ï¼Œæˆ‘å…ˆç·´éœå¿ƒåŠŸï¼Œç­‰ç­‰å†èªªã€‚",
  "æˆ‘ç¾åœ¨å…ˆç•¶å¤§äººï¼Œç­‰ä½ é¡˜æ„å†ç•¶æ•™ç·´ã€‚",
  "æˆ‘åµä¸éä½ ï¼Œæˆ‘è‡ªå·±å…ˆä¿å‘½ã€‚",
  "ä½ åœ¨ç·´æƒ…ç·’ï¼Œæˆ‘åœ¨ç·´å®šåŠ›ã€‚",
  "æˆ‘åµè´ä½ ï¼Œæœƒè¼¸æ‰ä½ ã€‚",
  "ä½ çš„ç«å¾ˆå¤§ï¼Œè¦ä¸è¦å–å£æ°´æ»…ç«ã€‚",
  "ä½ è¶Šå¤§è²ï¼Œæˆ‘å°±è¶Šå°è²ï¼Œé€™å«é™å™ªã€‚",
  "ä½ æ€¥ï¼Œæˆ‘ä¸æ€¥ï¼Œæ€¥ä¹Ÿä¸æœƒæ¯”è¼ƒå¿«ã€‚",
  "å…ˆæŠŠéŸ³é‡æ”¾å°ï¼Œæˆ‘æ‰è½å¾—åˆ°ã€‚"
];

const cheerList = [
  "ä½ ä»Šå¤©å·²ç¶“å¾ˆåŠªåŠ›äº†ï¼ŒçœŸçš„ã€‚",
  "æ²’æœ‰çˆ†ç‚¸ï¼Œæœ¬èº«å°±æ˜¯ä¸€ç¨®å¯¦åŠ›ã€‚",
  "ä½ æœ‰å›ä¾†ç…§é¡§è‡ªå·±ï¼Œç‚ºä½ æ‹æ‹æ‰‹ã€‚",
  "ä½ æ²’æœ‰æ”¾æ£„ï¼Œé€™ä¸€é»å¾ˆé‡è¦ã€‚",
  "é€™ä¸æ˜¯å®Œç¾çš„ä¸€å¤©ï¼Œä½†ä½ æ’ä½äº†ã€‚",
  "ä½ é¡˜æ„åœä¸€ä¸‹ï¼Œè¡¨ç¤ºä½ å¾ˆæ¸…é†’ã€‚",
  "ä»Šå¤©çš„ä½ ï¼Œå€¼å¾—ä¸€å¥ï¼šå¤ªå¸¥å•¦ï¼",
  "ä½ æ²’æœ‰æç ¸ï¼Œåªæ˜¯å¤ªç´¯äº†ã€‚",
  "é¡˜æ„ç”¨å·¥å…·çš„äººï¼Œéƒ½æ˜¯èªçœŸçš„äººã€‚",
  "ä½ å·²ç¶“æ‡‚å¾—å¤šç…§é¡§è‡ªå·±ä¸€é»äº†ã€‚"
];

/* =========================
   âœ… å½©è›‹å¥åº«ï¼ˆå¯æ“´å……ï¼‰
   - ä¸€å¤©æœ€å¤šè·³ä¸€æ¬¡ï¼ˆä¸åµï¼‰
   - ä¹Ÿæœƒæ··å…¥ä½ çš„è‡ªå‰µå¥å­ï¼ˆæ›´åƒã€Œäººã€ï¼‰
========================= */
const eggList = [
  "ğŸ¬ ä»Šæ—¥å½©è›‹ï¼šå‰›å‰›é‚£æ®µæƒ…ç·’ï¼Œå¦‚æœå‰ªè¼¯å¸«åœ¨ï¼Œä»–æœƒå¹«ä½ ä¸ŠæŸ”ç„¦ã€‚",
  "ğŸŠ ä»Šæ—¥å½©è›‹ï¼šä½ ä¸æ˜¯åœ¨å´©æ½°ï¼Œä½ æ˜¯åœ¨ã€Œæ©˜å­å»çš®ã€â€”â€”æœ‰é»é»ï¼Œä½†æœƒç”œã€‚",
  "ğŸ§  ä»Šæ—¥å½©è›‹ï¼šå‰é¡è‘‰æ­£åœ¨è¶•ä¾†çš„è·¯ä¸Šï¼Œè«‹å…ˆç”¨ä¸€å£æ°´å¹«å®ƒé–‹è·¯ã€‚",
  "ğŸ«¶ ä»Šæ—¥å½©è›‹ï¼šä½ å·²ç¶“å¾ˆåŠªåŠ›äº†ï¼Œä»Šå¤©å…ˆæŠŠè‡ªå·±æŠ±å›ä¾†ã€‚",
  "ğŸ§¯ ä»Šæ—¥å½©è›‹ï¼šä½ æ²’æœ‰è¼¸ï¼Œä½ åªæ˜¯é¸æ“‡ä¸å†ç”¨ç«è§£æ±ºç«ã€‚",
  "ğŸŒ¤ï¸ ä»Šæ—¥å½©è›‹ï¼šå…ˆè®“å¿ƒå›åˆ°èº«é«”è£¡ï¼Œå‰©ä¸‹çš„æ˜å¤©å†èªªã€‚",
  "ğŸˆ ä»Šæ—¥å½©è›‹ï¼šä½ å‰›å‰›åšåˆ°ä¸€ä»¶äº‹â€”â€”æ²’æœ‰æŠŠå°äº‹å‡ç´šæˆä¸–ç•Œæœ«æ—¥ã€‚",
  "ğŸ§¸ ä»Šæ—¥å½©è›‹ï¼šä½ ä¸æ˜¯æƒ…ç·’å¤ªå¤šï¼Œä½ æ˜¯è²¬ä»»å¤ªæ»¿ã€‚",
  "ğŸ’› ä»Šæ—¥å½©è›‹ï¼šé¡˜æ„å›ä¾†çš„äººï¼Œéƒ½å¾ˆå‹‡æ•¢ã€‚",
  "ğŸ˜„ ä»Šæ—¥å½©è›‹ï¼šåˆ¥æ€•ï¼Œä»Šå¤©çš„ä½ åªæ˜¯ã€Œç´¯åˆ°æ²’é–‹ç¾è‚Œã€ã€‚"
];

/* =========================
   é¡¯ç¤º
========================= */
function absurdRescue(){
  beep("tap");
  document.getElementById("absurdText").innerText = pick(absurdList);
}

function parentRescue(){
  beep("soft");
  const custom = loadCustom();
  const pool = parentList.concat(custom);
  document.getElementById("parentText").innerText = pick(pool);
}

function cheerMeUp(){
  beep("win");
  document.getElementById("cheerText").innerText = pick(cheerList);
}

/* =========================
   âœ… å½©è›‹ï¼šä¸€å¤©æœ€å¤šä¸€æ¬¡
========================= */
const LS_EGG_LAST = "HP_FUNNY_MOOD_PACK_EGG_LAST_DATE";
function todayKey(){
  const d = new Date();
  const y = d.getFullYear();
  const m = String(d.getMonth()+1).padStart(2,"0");
  const da = String(d.getDate()).padStart(2,"0");
  return `${y}-${m}-${da}`;
}

function showDailyEgg(force=false){
  const key = todayKey();
  const last = localStorage.getItem(LS_EGG_LAST) || "";
  if(!force && last === key){
    // å·²ç¶“çœ‹éä»Šå¤©å½©è›‹
    document.getElementById("eggText").innerText = "ä»Šå¤©çš„å½©è›‹ä½ å·²ç¶“é ˜éäº† ğŸ˜„ï¼ˆæƒ³å†çœ‹ä¸€æ¬¡å¯ä»¥å†æŒ‰ï¼‰";
    beep("soft");
    return;
  }

  // å½©è›‹æ± ï¼šå…§å»º + è‡ªå‰µå¥å­ï¼ˆæ›´æœ‰çœŸå¯¦æ„Ÿï¼‰
  const custom = loadCustom();
  const pool = eggList.concat(custom.length ? ["â€”â€” ä¾†è‡ªä½ è‡ªå·±ç•™ä¸‹çš„ä¸€å¥ï¼š\n" + pick(custom)] : []);
  document.getElementById("eggText").innerText = pick(pool);

  localStorage.setItem(LS_EGG_LAST, key);
  beep("surprise");
}

/* é€²ç«™è‡ªå‹•å½ˆä¸€æ¬¡ï¼ˆä½†ä¸€å¤©ä¸€æ¬¡ï¼‰ */
function autoEggOncePerDay(){
  const key = todayKey();
  const last = localStorage.getItem(LS_EGG_LAST) || "";
  if(last !== key){
    showDailyEgg(false);
  }
}

/* =========================
   ç‹‚æŒ‰èˆ’å£“é©šå–œ
========================= */
let smashCombo = 0;
let smashTimer = null;

const smashWords = [
  "å•ªï¼","å’šï¼","å‘¼â€”â€”","å“ˆå“ˆï¼","ä¸­çå›‰ï¼","å¤ªæœ‰æ‰äº†ï¼","çœŸè¡Œ",
  "å“‡å¡","å¾ˆå¯ä»¥ã€‚","ç¦æ°£åˆ°ã€‚"
];

const smashSurprises = [
  "ğŸˆ é©šå–œï¼šä½ å‰›å‰›æŒ‰æ‰äº† 1 é¡†ã€Œå§”å±ˆçƒã€ã€‚",
  "ğŸŠ é©šå–œï¼šæƒ…ç·’å·²åˆ‡æ›æˆã€Œæ©˜å­æ¨¡å¼ã€ï¼šé…¸ç”œå¯æ§ã€‚",
  "ğŸ§  é©šå–œï¼šå‰é¡è‘‰å›ä¾†ä¸Šç­äº†ï¼ˆä½†å¯èƒ½é‚„åœ¨è·¯ä¸Šï¼‰ã€‚",
  "ğŸ«¶ é©šå–œï¼šä½ å·²ç¶“å¤ å¥½äº†ï¼Œå…ˆä¼‘æ¯ä¸€ä¸‹ã€‚",
  "ğŸ¬ é©šå–œï¼šé€™æ®µå¯ä»¥å‰ªæ‰ï¼Œæ”¹æˆæº«æŸ”ç‰ˆã€‚",
  "ğŸ§¯ é©šå–œï¼šä½ å‰›å‰›å…¶å¯¦åœ¨æ»…ç«ã€‚å¾ˆæœƒã€‚"
];

function smash(){
  // é€£æŒ‰åˆ¤å®šï¼š900ms å…§ç®— combo
  clearTimeout(smashTimer);
  smashTimer = setTimeout(()=>{ smashCombo = 0; document.getElementById("smashSpark").innerText = ""; }, 900);
  smashCombo++;

  // åŸºæœ¬æŒ‰éµè²ï¼šè¶ŠæŒ‰è¶Šåƒå’šå’šå’šï¼ˆä½†ä»å¯æ„›ï¼‰
  beep(smashCombo >= 10 ? "smash" : "tap");

  let text = pick(smashWords);

  if(smashCombo === 5){
    text = "å¥½ï¼Œé€™ä¸€è¼ªæŒ‰å¾—å¾ˆæœ‰æ„Ÿè¦ºã€‚";
  }else if(smashCombo === 10){
    text = "ä½ å·²ç¶“æŒ‰æ‰ä¸å°‘æƒ…ç·’äº† ğŸ˜‚";
  }else if(smashCombo === 15){
    text = pick(smashSurprises);
    beep("surprise"); // âœ… å½©è›‹éŸ³
    smashCombo = 0;   // é‡ç½®ï¼Œé¿å…å£“åŠ›
  }

  document.getElementById("smashText").innerText = text;
  document.getElementById("smashSpark").innerText = `é€£æŒ‰ï¼š${smashCombo}ï¼ˆæƒ³åœå°±åœï¼‰`;
}

/* =========================
   è‡ªå‰µå¥åº«ï¼ˆå¯æ–°å¢/åˆªé™¤ï¼‰
========================= */
const LS_KEY = "HP_FUNNY_MOOD_PACK_V12_CUSTOM";

function loadCustom(){
  try{ return JSON.parse(localStorage.getItem(LS_KEY) || "[]"); }
  catch(e){ return []; }
}

function saveCustom(){
  beep("tap");
  const input = document.getElementById("customInput");
  const v = (input.value || "").trim();
  if(!v) return;

  const list = loadCustom();
  list.unshift(v);
  // å»é‡
  const uniq = Array.from(new Set(list));
  localStorage.setItem(LS_KEY, JSON.stringify(uniq.slice(0, 60)));
  input.value = "";
  renderCustom();
  alert("å·²å­˜ âœ… ä¸‹æ¬¡æœƒæŠ½åˆ°");
}

function deleteCustom(idx){
  beep("soft");
  const list = loadCustom();
  list.splice(idx, 1);
  localStorage.setItem(LS_KEY, JSON.stringify(list));
  renderCustom();
}

function useCustom(text){
  beep("soft");
  document.getElementById("parentText").innerText = text;
}

function renderCustom(){
  const box = document.getElementById("customList");
  const list = loadCustom();
  box.innerHTML = "";

  if(list.length === 0){
    const d = document.createElement("div");
    d.className = "tiny";
    d.style.textAlign = "left";
    d.textContent = "ç›®å‰é‚„æ²’æœ‰è‡ªå‰µå¥å­ã€‚ä½ å­˜ä¸€å¥ï¼Œä¸‹æ¬¡å°±æœƒå‡ºç¾ã€‚";
    box.appendChild(d);
    return;
  }

  list.forEach((t, i)=>{
    const row = document.createElement("div");
    row.className = "item";

    const b = document.createElement("button");
    b.className = "itemBtn";
    b.type = "button";
    b.textContent = t;
    b.onclick = ()=> useCustom(t);

    const del = document.createElement("button");
    del.className = "delBtn";
    del.type = "button";
    del.textContent = "åˆªé™¤";
    del.onclick = ()=> deleteCustom(i);

    row.appendChild(b);
    row.appendChild(del);
    box.appendChild(row);
  });
}

/* init */
renderCustom();

/* å°æé†’ï¼šæœ‰äº›æ‰‹æ©Ÿéœ€è¦ã€Œç¬¬ä¸€æ¬¡é»æ“Šã€æ‰æœƒå•Ÿå‹•éŸ³æ•ˆ */
document.addEventListener("click", ()=>{ ensureAudio(); }, { once:true });

/* âœ… é€²ç«™ï¼šå½©è›‹ä¸€å¤©æœ€å¤šä¸€æ¬¡ï¼ˆä¸åµï¼‰ */
window.addEventListener("load", ()=>{ autoEggOncePerDay(); });

/* âœ… PWAï¼šè¨»å†Š Service Workerï¼ˆæ‰æœƒçœŸæ­£å¯å®‰è£/é›¢ç·šï¼‰ */
if("serviceWorker" in navigator){
  window.addEventListener("load", ()=>{
    navigator.serviceWorker.register("./sw.js").catch(()=>{});
  });
}
</script>
</body>
</html>